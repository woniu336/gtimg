# æ³¨æ„äº‹é¡¹

éœ€è¦åœ¨imgæ ‡ç­¾åŠ é˜²ç›—é“¾

```
referrerpolicy="no-referrer"
```



åå°é»˜è®¤ç™»å½•ç”¨æˆ·åå’Œå¯†ç ï¼š`admin/admin123`

ä¿®æ”¹å¯†ç ï¼šconfig.php

## å¿«é€Ÿä¸Šæ‰‹

### 1. è·å–æˆæƒä¿¡æ¯

é¦–å…ˆéœ€è¦è·å–è…¾è®¯å¼€æ”¾åª’ä½“å¹³å°çš„ Cookieï¼š

1. è®¿é—® [è…¾è®¯å¼€æ”¾åª’ä½“å¹³å°](https://om.qq.com/userAuth/index)
2. ä½¿ç”¨å¾®ä¿¡æ‰«ç ç™»å½•
3. æŒ‰ F12 æ‰“å¼€å¼€å‘è€…å·¥å…·ï¼Œæ‰¾åˆ° Cookie ä¿¡æ¯

> ğŸ’¡ **é‡è¦æç¤º**ï¼šæˆ‘ä»¬åªéœ€è¦ Cookie ä¸­ä» **userid** å¼€å§‹çš„éƒ¨åˆ†ï¼Œä¾‹å¦‚ï¼š
```
userid=23510990; omaccesstoken=xxx; omtoken=xxx; logintype=4; srcopenid=xxx; srcaccessToken=xxx
```
![image.png](https://inews.gtimg.com/om_ls/OOPlRSNvyB3i378FYznc9jSaGzgK0osWYf0ZpJ4-71OfQAA/0)


### 2. é…ç½®å›¾åºŠ

å°†è·å–åˆ°çš„ Cookie å¡«å…¥ `upload.php` æ–‡ä»¶ä¸­ï¼š

```php:upload.php
private $token = 'æŠŠä¸Šé¢è·å–åˆ°çš„Cookieç²˜è´´åœ¨è¿™é‡Œ'
```

å®Œæˆé…ç½®åï¼Œå°±å¯ä»¥å¼€å§‹ä½¿ç”¨å›¾åºŠæœåŠ¡äº†ï¼

### 3. æ•°æ®å¤‡ä»½æ–¹æ¡ˆ

ä¸ºäº†ç¡®ä¿æ•°æ®å®‰å…¨ï¼Œæˆ‘æ¨èä½¿ç”¨ rclone é…åˆ Cloudflare R2 è¿›è¡Œè‡ªåŠ¨å¤‡ä»½ã€‚ä»¥ä¸‹æ˜¯ç»è¿‡ä¼˜åŒ–çš„å¤‡ä»½å‘½ä»¤ï¼š

```bash
rclone copy /www/wwwroot/1234.com/uploads r2:img/gtimg/uploads \
    --ignore-existing \
    -u -v -P \
    --transfers=20 \
    --ignore-errors \
    --buffer-size=64M \
    --check-first \
    --checkers=15 \
    --drive-acknowledge-abuse
```

å‚æ•°è¯´æ˜ï¼š
- `/www/wwwroot/1234.com/uploads`ï¼šæœ¬åœ°å›¾ç‰‡ç›®å½•
- `r2:img/gtimg/uploads`ï¼šR2 å­˜å‚¨è·¯å¾„ï¼ˆå…¶ä¸­ `img` ä¸ºä½ çš„ R2 å­˜å‚¨æ¡¶åç§°ï¼‰
- å…¶ä»–å‚æ•°å·²ä¼˜åŒ–ä¸ºæœ€ä½³æ€§èƒ½é…ç½®

## ç‰¹åˆ«è¯´æ˜

âš ï¸ **ä½¿ç”¨é™åˆ¶**ï¼šç›®å‰ä¸æ”¯æŒä¸Šä¼  avif æ ¼å¼çš„å›¾ç‰‡


## å›¾ç‰‡æ¢å¤æ–¹æ¡ˆ

å¦‚æœå›¾åºŠæœåŠ¡å‡ºç°é—®é¢˜ï¼Œå¯ä»¥é€šè¿‡ä»¥ä¸‹æ­¥éª¤å¿«é€Ÿæ¢å¤ï¼š

1. ä½¿ç”¨å¤‡ä»½ä¸­çš„å›¾ç‰‡æ–‡ä»¶
2. æ‰¹é‡æ›¿æ¢é“¾æ¥å‰ç¼€ `https://inews.gtimg.com/om_ls`
3. æŠŠ/0æ›¿æ¢æˆ.webp

è¿™æ ·çš„è®¾è®¡ç¡®ä¿äº†å³ä½¿æœåŠ¡ä¸­æ–­ï¼Œä½ çš„å›¾ç‰‡èµ„æºä¹Ÿä¸ä¼šä¸¢å¤±ã€‚

---